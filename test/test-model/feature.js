var tcat=require("./token-categories.js"),tcat2pos=Array(tcat.list.length);tcat2pos.fill(0),tcat2pos[0]=17,tcat2pos[2]=9,tcat2pos[3]=15,tcat2pos[4]=15,tcat2pos[4]=15,tcat2pos[5]=12,tcat2pos[6]=15,tcat2pos[7]=15,tcat2pos[8]=15,tcat2pos[9]=15,tcat2pos[10]=11,tcat2pos[11]=15,tcat2pos[12]=13,tcat2pos[13]=15,tcat2pos[14]=14,tcat2pos[18]=9;var suffix2pos=Object.create(null);suffix2pos.ing=16,suffix2pos.ed=16,suffix2pos.ly=3,suffix2pos.able=1,suffix2pos.ous=1,suffix2pos.ful=1,suffix2pos.ary=1,suffix2pos.less=1,suffix2pos.ier=1,suffix2pos.est=1;var prefix2pos=Object.create(null),feature=function(a,b,c,d){const e=/^[A-Z][a-z\-\–\—\.]*$/;var f,g=[],h=b?b.trex.lex:null,j=b?h.length:0;const k=c;var l=Object.create(null),m=function(a){var b=a.toLowerCase(),c=suffix2pos[b.slice(-4)]||suffix2pos[b.slice(-3)]||suffix2pos[b.slice(-2)]||prefix2pos[b.slice(0,5)]||prefix2pos[b.slice(0,4)]||prefix2pos[b.slice(0,3)]||prefix2pos[b.slice(0,2)];return void 0===c?e.test(a)?12:8:c};for(f=0;f<j;f+=1)g.push([new RegExp(h[f][0],h[f][1]),h[f][2]]);return l.shape=function(a){return a.replace(/[A-Z]{4,}/g,"XXXX").replace(/[A-Z]/g,"X").replace(/[a-z]{4,}/g,"xxxx").replace(/[a-z]/g,"x").replace(/\d{4,}/g,"dddd").replace(/\d/g,"d")},l.suffix=function(b){return b.slice(-a.suffix)},l.prefix=function(b){return b.slice(0,a.prefix)},l.lexeme=function(a){return a},l.lexemeCID=function(a){return a},l.isAbbrev=function(a){return /[a-z].*\.$/i.test(a)?1:0},l.normal=function(a){const b=k.lexeme.hash[a.toLowerCase()];if(void 0===b)return console.log("\x1B[41m%s\x1B[0m entry is missing! (feature.normal)",JSON.stringify(a.toLowerCase())),0;const c=b-k.lexeme.hash[a];if(0>c||3<c)throw new Error("feature.normal: offset of "+c+" for "+JSON.stringify(a));return c},l.tokenType=function(a){var b;for(b=0;b<g.length;b+=1)if(g[b][0].test(a))return g[b][1];return console.log("\x1B[41m%s\x1B[0m has unknown token type! (feature.tokenType)",JSON.stringify(a)),tcat.hash.word},l.pos=function(a,c,f){if(d){const c=k.pos.hash[a];return c?b.xpos.hash[c&&1===c.length?c[0]:"UNK"]:b.xpos.hash.UNK}var g,h;if(c===tcat.hash.word){h=a.toLowerCase();const b=f.lookup(h)[0];if(b<f.intrinsicSize()){const c=f.posOf(b);g=e.test(a)&&8===c?12:c}else g=m(a)}return g||tcat2pos[c]||(e.test(a)?12:8)},l.isSPoS=function(a){const b=k.pos.hash[a];return b&&1===b.length?1:0},l.lemma=function(a){if(0===k.lexeme.hash[a])return 0;const b=k.lemma.hash[a];return void 0===b||void 0===k.lexeme.hash[b[0]]?(console.log("\x1B[41m%s\x1B[0m entry is missing! (feature.lemma)",JSON.stringify(b[0])),0):k.lexeme.hash[b[0]]},l.isSLemma=function(a){if(0===k.lexeme.hash[a])return 0;const b=k.lemma.hash[a];return b&&k.lexeme.hash[b[0]]&&1===b.length?1:0},l.lutCase=function(a){return /^[a-z][a-z\-\–\—\.]*$/.test(a)?1:/^[A-Z][A-Z\-\–\—\.]*$/.test(a)?2:e.test(a)?3:0},l};module.exports=feature;
